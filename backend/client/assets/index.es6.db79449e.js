import{E as se,ae as oe,G as le,a6 as re,a3 as ie,x as T,aM as ue,d as Q,k as fe,o as z,aa as P,a as C,w as y,aG as ce,aH as W,a8 as M,aI as ve,aJ as F,Q as Y,aK as G,aL as pe,ac as H,ad as de,c as q,aS as me,I as ge,aT as he,aU as we,a5 as Z,a7 as X,a4 as ye,H as Ce,J as _e,h as _,b as te,aV as be,aW as ke,$ as xe,ah as Be,a0 as Ee,al as Le,T as Ne,j as ze,K as De}from"./index.d78f815c.js";import{Q as j}from"./QSelect.77d64708.js";import{Q as Qe,b as Te}from"./QMenu.c8dbaa4e.js";import{_ as Ie}from"./towerSelect.9436c179.js";const $e=Ce("div",null,"Unsaved changes",-1),Oe={key:0,class:"tw-text-gray-500"},Ye=se({__name:"baseToolbar",emits:["update:baseModels"],setup(t,{emit:e}){const a=oe(),s=le(),i=re(),o=ie(),n=T({items:[],values:[],loading:[]}),v=T(!1),f=T(!1),c=T(null),h=T([]);ue(async()=>{await N()});const m=Q(()=>a.getBases),b=Q(()=>`tw-grid-cols-${m.value.length}`),B=Q(()=>{let u="";return n.value.values.forEach(p=>{p&&(u?u+=`/${p.name}`:u=p.name)}),u}),D=Q(()=>o.getCanNavigate),d=async u=>{if(u>=m.value.length)return;v.value=!0,n.value.loading[u]=!0;const p={where:{base:m.value[u].name},order:"name"},l=await _e.get(`configurationModels?filter=${JSON.stringify(p,null,"")}`);if(l.status===200){let r=[{base:m.value[u].name,name:"__NONE__",options:{hasRestrictions:!1}},...l.data];if(u===0)n.value.items[u]=r;else{const g={};for(let x=0;x<u;x++){const S=n.value.values[x];g[S.base]=S.name}r=r.filter(x=>x.options.hasRestrictions?!x.restrictions.some(A=>Object.keys(A).some(V=>{if(V!=="__id"&&A[V])return A[V]!==g[V]})):!0),n.value.items[u]=r}}n.value.loading[u]=!1,v.value=!1},w=async u=>{if(!D.value){f.value=!0,c.value={...u};return}let p="";for(let l of n.value.values)if(l&&typeof l=="object")l.name==="__NONE__"?p+="/_":p+=`/${l.name}`;else break;if(i.path.startsWith("/configuration")&&await s.push(`/configuration${p}`),u){const l=m.value.find(r=>r.name===u.base);if(l){for(let r=l.sequenceNumber+1;r<m.value.length;r++)n.value.values[r]="",n.value.items[r]=[];l.sequenceNumber+1<=m.value.length&&await d(l.sequenceNumber+1)}}else{let l=!1;for(let r=0;r<m.value.length;r++)l?(n.value.items[r]=[],n.value.values[r]="",n.value.loading[r]=!1):n.value.values[r]===null&&(l=!0,n.value.items[r]=[],n.value.values[r]="",n.value.loading[r]=!1,r<=m.value.length&&await d(r))}h.value=[...n.value.values],e("update:baseModels",n.value.values)},E=u=>{var p;return u===0?!1:!((p=n.value.values[u-1])!=null&&p.name)},L=async u=>{let p=null;for(let l=0;l<a.getBases.length;l++){const r=a.getBases[l];if(u[r.name]!==void 0){const g=n.value.items[l].find(x=>x.name===u[r.name]);g&&(n.value.values[l]=g,p=g,await d(l+1))}else l=a.getBases.length}p&&await w(p)},N=async()=>{if(m.value.forEach((u,p)=>{n.value.items[p]=[],n.value.values[p]="",n.value.loading[p]=!1}),await d(0),i.params.configurationPath){const u={},p=i.params.configurationPath.split("/");for(let l=0;l<a.getBases.length;l++){const r=a.getBases[l].name;let g=p[l];g&&(g==="_"&&(g="__NONE__"),u[r]=g)}await L(u)}},$=()=>{c.value&&(o.allowNavigation(),w(c.value))},O=()=>{n.value.values=[...h.value]};return fe(i,async()=>{B.value.replace(/__NONE__/,"_")!==i.params.configurationPath&&await N()}),(u,p)=>(z(),P("div",{class:ye([X(b),"tw-bg-darkPage tw-text-secondary tw-gap-3 tw-grid tw-px-4 tw-pb-3 tw-pt-3 tw-rounded"])},[C(pe,{modelValue:f.value,"onUpdate:modelValue":p[0]||(p[0]=l=>f.value=l),persistent:""},{default:y(()=>[C(ce,{style:{width:"30rem"}},{default:y(()=>[C(W,{class:"tw-text-sm tw-font-semibold tw-bg-accent tw-text-black"},{default:y(()=>[$e]),_:1}),C(W,null,{default:y(()=>[M(" There are unsaved changes, are you sure you want to leave this page? ")]),_:1}),C(ve,{align:"right"},{default:y(()=>[F(C(Y,{flat:"",label:"Cancel",onClick:O},null,512),[[G]]),F(C(Y,{class:"tw-text-accent",flat:"",label:"Leave",onClick:$},null,512),[[G]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),(z(!0),P(H,null,de(X(m),(l,r)=>(z(),q(Ie,{key:l.name,modelValue:n.value.values[r],"onUpdate:modelValue":[g=>n.value.values[r]=g,w],disable:E(r)||v.value,label:l.name,loading:n.value.loading[r],options:n.value.items[r],clearable:"","option-label":"name"},me({option:y(g=>[C(Qe,he(we(g.itemProps)),{default:y(()=>[C(Te,null,{default:y(()=>[g.opt.name==="__NONE__"?(z(),q(j,{key:0,class:"tw-text-gray-500"},{default:y(()=>[M("EMPTY ")]),_:1})):(z(),q(j,{key:1},{default:y(()=>[M(Z(g.opt.name),1)]),_:2},1024))]),_:2},1024)]),_:2},1040)]),"selected-item":y(g=>[g.opt.name==="__NONE__"?(z(),P("span",Oe,"EMPTY")):(z(),P(H,{key:1},[M(Z(g.opt.name),1)],64))]),_:2},[l.icon?{name:"prepend",fn:y(()=>[C(ge,{name:l.icon},null,8,["name"])]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue","disable","label","loading","options"]))),128))],2))}}),Ve=[_("circle",{cx:"50",cy:"50",r:"48",fill:"none","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor"}),_("line",{"stroke-linecap":"round","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor",x1:"50",y1:"50",x2:"85",y2:"50.5"},[_("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"360 50 50",dur:"2s",repeatCount:"indefinite"})]),_("line",{"stroke-linecap":"round","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor",x1:"50",y1:"50",x2:"49.5",y2:"74"},[_("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"360 50 50",dur:"15s",repeatCount:"indefinite"})])];var Ge=te({name:"QSpinnerClock",props:be,setup(t){const{cSize:e,classes:a}=ke(t);return()=>_("svg",{class:a.value,width:e.value,height:e.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg"},Ve)}}),He=te({name:"QInnerLoading",props:{...xe,...Be,showing:Boolean,color:String,size:{type:[String,Number],default:42},label:String,labelClass:String,labelStyle:[String,Array,Object]},setup(t,{slots:e}){const a=ze(),s=Ee(t,a.proxy.$q),{transitionProps:i,transitionStyle:o}=Le(t),n=Q(()=>"q-inner-loading absolute-full column flex-center"+(s.value===!0?" q-inner-loading--dark":"")),v=Q(()=>"q-inner-loading__label"+(t.labelClass!==void 0?` ${t.labelClass}`:""));function f(){const h=[_(De,{size:t.size,color:t.color})];return t.label!==void 0&&h.push(_("div",{class:v.value,style:t.labelStyle},[t.label])),h}function c(){return t.showing===!0?_("div",{class:n.value,style:o.value},e.default!==void 0?e.default():f()):null}return()=>_(Ne,i.value,c)}});function k(){}k.prototype={diff:function(e,a){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=s.callback;typeof s=="function"&&(i=s,s={}),this.options=s;var o=this;function n(d){return i?(setTimeout(function(){i(void 0,d)},0),!0):d}e=this.castInput(e),a=this.castInput(a),e=this.removeEmpty(this.tokenize(e)),a=this.removeEmpty(this.tokenize(a));var v=a.length,f=e.length,c=1,h=v+f;s.maxEditLength&&(h=Math.min(h,s.maxEditLength));var m=[{newPos:-1,components:[]}],b=this.extractCommon(m[0],a,e,0);if(m[0].newPos+1>=v&&b+1>=f)return n([{value:this.join(a),count:a.length}]);function B(){for(var d=-1*c;d<=c;d+=2){var w=void 0,E=m[d-1],L=m[d+1],N=(L?L.newPos:0)-d;E&&(m[d-1]=void 0);var $=E&&E.newPos+1<v,O=L&&0<=N&&N<f;if(!$&&!O){m[d]=void 0;continue}if(!$||O&&E.newPos<L.newPos?(w=Me(L),o.pushComponent(w.components,void 0,!0)):(w=E,w.newPos++,o.pushComponent(w.components,!0,void 0)),N=o.extractCommon(w,a,e,d),w.newPos+1>=v&&N+1>=f)return n(Pe(o,w.components,a,e,o.useLongestToken));m[d]=w}c++}if(i)(function d(){setTimeout(function(){if(c>h)return i();B()||d()},0)})();else for(;c<=h;){var D=B();if(D)return D}},pushComponent:function(e,a,s){var i=e[e.length-1];i&&i.added===a&&i.removed===s?e[e.length-1]={count:i.count+1,added:a,removed:s}:e.push({count:1,added:a,removed:s})},extractCommon:function(e,a,s,i){for(var o=a.length,n=s.length,v=e.newPos,f=v-i,c=0;v+1<o&&f+1<n&&this.equals(a[v+1],s[f+1]);)v++,f++,c++;return c&&e.components.push({count:c}),e.newPos=v,f},equals:function(e,a){return this.options.comparator?this.options.comparator(e,a):e===a||this.options.ignoreCase&&e.toLowerCase()===a.toLowerCase()},removeEmpty:function(e){for(var a=[],s=0;s<e.length;s++)e[s]&&a.push(e[s]);return a},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};function Pe(t,e,a,s,i){for(var o=0,n=e.length,v=0,f=0;o<n;o++){var c=e[o];if(c.removed){if(c.value=t.join(s.slice(f,f+c.count)),f+=c.count,o&&e[o-1].added){var m=e[o-1];e[o-1]=e[o],e[o]=m}}else{if(!c.added&&i){var h=a.slice(v,v+c.count);h=h.map(function(B,D){var d=s[f+D];return d.length>B.length?d:B}),c.value=t.join(h)}else c.value=t.join(a.slice(v,v+c.count));v+=c.count,c.added||(f+=c.count)}}var b=e[n-1];return n>1&&typeof b.value=="string"&&(b.added||b.removed)&&t.equals("",b.value)&&(e[n-2].value+=b.value,e.pop()),e}function Me(t){return{newPos:t.newPos,components:t.components.slice(0)}}var Re=new k;function Ze(t,e,a){return Re.diff(t,e,a)}var K=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,ee=/\S/,ae=new k;ae.equals=function(t,e){return this.options.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t===e||this.options.ignoreWhitespace&&!ee.test(t)&&!ee.test(e)};ae.tokenize=function(t){for(var e=t.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),a=0;a<e.length-1;a++)!e[a+1]&&e[a+2]&&K.test(e[a])&&K.test(e[a+2])&&(e[a]+=e[a+2],e.splice(a+1,2),a--);return e};var ne=new k;ne.tokenize=function(t){var e=[],a=t.split(/(\n|\r\n)/);a[a.length-1]||a.pop();for(var s=0;s<a.length;s++){var i=a[s];s%2&&!this.options.newlineIsToken?e[e.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),e.push(i))}return e};var Se=new k;Se.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};var Ae=new k;Ae.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function R(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?R=function(e){return typeof e}:R=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(t)}var qe=Object.prototype.toString,I=new k;I.useLongestToken=!0;I.tokenize=ne.tokenize;I.castInput=function(t){var e=this.options,a=e.undefinedReplacement,s=e.stringifyReplacer,i=s===void 0?function(o,n){return typeof n=="undefined"?a:n}:s;return typeof t=="string"?t:JSON.stringify(J(t,null,null,i),i,"  ")};I.equals=function(t,e){return k.prototype.equals.call(I,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function J(t,e,a,s,i){e=e||[],a=a||[],s&&(t=s(i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return a[o];var n;if(qe.call(t)==="[object Array]"){for(e.push(t),n=new Array(t.length),a.push(n),o=0;o<t.length;o+=1)n[o]=J(t[o],e,a,s,i);return e.pop(),a.pop(),n}if(t&&t.toJSON&&(t=t.toJSON()),R(t)==="object"&&t!==null){e.push(t),n={},a.push(n);var v=[],f;for(f in t)t.hasOwnProperty(f)&&v.push(f);for(v.sort(),o=0;o<v.length;o+=1)f=v[o],n[f]=J(t[f],e,a,s,f);e.pop(),a.pop()}else n=t;return n}var U=new k;U.tokenize=function(t){return t.slice()};U.join=U.removeEmpty=function(t){return t};export{He as Q,Ye as _,Ge as a,Ze as d};
