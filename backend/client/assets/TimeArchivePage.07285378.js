import{d as _,b5 as $t,b6 as ta,b7 as It,b as Vt,$ as Tt,a0 as pt,x as F,k as ke,h,T as ge,f as Ft,j as jt,D as st,Q as X,b8 as aa,aJ as ct,aw as na,N as la,E as oa,ae as ua,aa as _t,a as Q,w as se,aL as ra,H as he,a7 as lt,J as ia,o as ot,aG as sa,aH as bt,aI as ca,c as da,a9 as xt,a5 as kt,I as va,aK as Ct}from"./index.d78f815c.js";import{u as fa}from"./use-cache.b0833c75.js";import{a as At,i as Et,h as Bt}from"./use-key-composition.8fe7b499.js";import{p as q,c as ma}from"./QSelect.77d64708.js";import{T as ha}from"./TouchPan.6e4e3118.js";import{Q as ga}from"./QSeparator.ac17e27e.js";import{_ as ya}from"./index.es6.db79449e.js";import{_ as Da}from"./searchToolbar.a33518ca.js";import{C as Ma}from"./compareTable.b4f845a3.js";import{u as wa}from"./use-quasar.6ef15f16.js";import"./uid.42677368.js";import"./QMenu.c8dbaa4e.js";import"./selection.faaa34c1.js";import"./rtl.b51694b1.js";import"./touch.70a9dd44.js";import"./towerSelect.9436c179.js";import"./QInput.72a273ff.js";import"./QTooltip.cf77d385.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./constantVariable.1ceb2543.js";const ye=[-61,9,38,199,426,686,756,818,1111,1181,1210,1635,2060,2097,2192,2262,2324,2394,2456,3178];function _a(e,n,s){return Object.prototype.toString.call(e)==="[object Date]"&&(s=e.getDate(),n=e.getMonth()+1,e=e.getFullYear()),Ca(mt(e,n,s))}function St(e,n,s){return zt(ka(e,n,s))}function ba(e){return xa(e)===0}function We(e,n){return n<=6?31:n<=11||ba(e)?30:29}function xa(e){const n=ye.length;let s=ye[0],o,u,c,w,d;if(e<s||e>=ye[n-1])throw new Error("Invalid Jalaali year "+e);for(d=1;d<n&&(o=ye[d],u=o-s,!(e<o));d+=1)s=o;return w=e-s,u-w<6&&(w=w-u+V(u+4,33)*33),c=ee(ee(w+1,33)-1,4),c===-1&&(c=4),c}function Nt(e,n){const s=ye.length,o=e+621;let u=-14,c=ye[0],w,d,b,$,y;if(e<c||e>=ye[s-1])throw new Error("Invalid Jalaali year "+e);for(y=1;y<s&&(w=ye[y],d=w-c,!(e<w));y+=1)u=u+V(d,33)*8+V(ee(d,33),4),c=w;$=e-c,u=u+V($,33)*8+V(ee($,33)+3,4),ee(d,33)===4&&d-$===4&&(u+=1);const C=V(o,4)-V((V(o,100)+1)*3,4)-150,z=20+u-C;return n||(d-$<6&&($=$-d+V(d+4,33)*33),b=ee(ee($+1,33)-1,4),b===-1&&(b=4)),{leap:b,gy:o,march:z}}function ka(e,n,s){const o=Nt(e,!0);return mt(o.gy,3,o.march)+(n-1)*31-V(n,7)*(n-7)+s-1}function Ca(e){const n=zt(e).gy;let s=n-621,o,u,c;const w=Nt(s,!1),d=mt(n,3,w.march);if(c=e-d,c>=0){if(c<=185)return u=1+V(c,31),o=ee(c,31)+1,{jy:s,jm:u,jd:o};c-=186}else s-=1,c+=179,w.leap===1&&(c+=1);return u=7+V(c,30),o=ee(c,30)+1,{jy:s,jm:u,jd:o}}function mt(e,n,s){let o=V((e+V(n-8,6)+100100)*1461,4)+V(153*ee(n+9,12)+2,5)+s-34840408;return o=o-V(V(e+100100+V(n-8,6),100)*3,4)+752,o}function zt(e){let n=4*e+139361631;n=n+V(V(4*e+183187720,146097)*3,4)*4-3908;const s=V(ee(n,1461),4)*5+308,o=V(ee(s,153),5)+1,u=ee(V(s,153),12)+1;return{gy:V(n,1461)-100100+V(8-u,6),gm:u,gd:o}}function V(e,n){return~~(e/n)}function ee(e,n){return e-~~(e/n)*n}const Sa=["gregorian","persian"],Zt={modelValue:{required:!0},mask:{type:String},locale:Object,calendar:{type:String,validator:e=>Sa.includes(e),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},Qt=["update:modelValue"];function ce(e){return e.year+"/"+q(e.month)+"/"+q(e.day)}function Pt(e,n){const s=_(()=>e.disable!==!0&&e.readonly!==!0),o=_(()=>s.value===!0?0:-1),u=_(()=>{const d=[];return e.color!==void 0&&d.push(`bg-${e.color}`),e.textColor!==void 0&&d.push(`text-${e.textColor}`),d.join(" ")});function c(){return e.locale!==void 0?{...n.lang.date,...e.locale}:n.lang.date}function w(d){const b=new Date,$=d===!0?null:0;if(e.calendar==="persian"){const y=_a(b);return{year:y.jy,month:y.jm,day:y.jd}}return{year:b.getFullYear(),month:b.getMonth()+1,day:b.getDate(),hour:$,minute:$,second:$,millisecond:$}}return{editable:s,tabindex:o,headerClass:u,getLocale:c,getCurrentDate:w}}const Lt=864e5,Ya=36e5,dt=6e4,Ut="YYYY-MM-DDTHH:mm:ss.SSSZ",qa=/\[((?:[^\]\\]|\\]|\\)*)\]|d{1,4}|M{1,4}|m{1,2}|w{1,2}|Qo|Do|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]/g,Ha=/(\[[^\]]*\])|d{1,4}|M{1,4}|m{1,2}|w{1,2}|Qo|Do|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]|([.*+:?^,\s${}()|\\]+)/g,ut={};function Oa(e,n){const s="("+n.days.join("|")+")",o=e+s;if(ut[o]!==void 0)return ut[o];const u="("+n.daysShort.join("|")+")",c="("+n.months.join("|")+")",w="("+n.monthsShort.join("|")+")",d={};let b=0;const $=e.replace(Ha,C=>{switch(b++,C){case"YY":return d.YY=b,"(-?\\d{1,2})";case"YYYY":return d.YYYY=b,"(-?\\d{1,4})";case"M":return d.M=b,"(\\d{1,2})";case"MM":return d.M=b,"(\\d{2})";case"MMM":return d.MMM=b,w;case"MMMM":return d.MMMM=b,c;case"D":return d.D=b,"(\\d{1,2})";case"Do":return d.D=b++,"(\\d{1,2}(st|nd|rd|th))";case"DD":return d.D=b,"(\\d{2})";case"H":return d.H=b,"(\\d{1,2})";case"HH":return d.H=b,"(\\d{2})";case"h":return d.h=b,"(\\d{1,2})";case"hh":return d.h=b,"(\\d{2})";case"m":return d.m=b,"(\\d{1,2})";case"mm":return d.m=b,"(\\d{2})";case"s":return d.s=b,"(\\d{1,2})";case"ss":return d.s=b,"(\\d{2})";case"S":return d.S=b,"(\\d{1})";case"SS":return d.S=b,"(\\d{2})";case"SSS":return d.S=b,"(\\d{3})";case"A":return d.A=b,"(AM|PM)";case"a":return d.a=b,"(am|pm)";case"aa":return d.aa=b,"(a\\.m\\.|p\\.m\\.)";case"ddd":return u;case"dddd":return s;case"Q":case"d":case"E":return"(\\d{1})";case"Qo":return"(1st|2nd|3rd|4th)";case"DDD":case"DDDD":return"(\\d{1,3})";case"w":return"(\\d{1,2})";case"ww":return"(\\d{2})";case"Z":return d.Z=b,"(Z|[+-]\\d{2}:\\d{2})";case"ZZ":return d.ZZ=b,"(Z|[+-]\\d{2}\\d{2})";case"X":return d.X=b,"(-?\\d+)";case"x":return d.x=b,"(-?\\d{4,})";default:return b--,C[0]==="["&&(C=C.substring(1,C.length-1)),C.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}),y={map:d,regex:new RegExp("^"+$)};return ut[o]=y,y}function Kt(e,n){return e!==void 0?e:n!==void 0?n.date:ta.date}function Yt(e,n=""){const s=e>0?"-":"+",o=Math.abs(e),u=Math.floor(o/60),c=o%60;return s+q(u)+n+q(c)}function $a(e,n,s){let o=e.getFullYear(),u=e.getMonth();const c=e.getDate();return n.year!==void 0&&(o+=s*n.year,delete n.year),n.month!==void 0&&(u+=s*n.month,delete n.month),e.setDate(1),e.setMonth(2),e.setFullYear(o),e.setMonth(u),e.setDate(Math.min(c,yt(e))),n.date!==void 0&&(e.setDate(e.getDate()+s*n.date),delete n.date),e}function Ia(e,n,s){const o=n.year!==void 0?n.year:e[`get${s}FullYear`](),u=n.month!==void 0?n.month-1:e[`get${s}Month`](),c=new Date(o,u+1,0).getDate(),w=Math.min(c,n.date!==void 0?n.date:e[`get${s}Date`]());return e[`set${s}Date`](1),e[`set${s}Month`](2),e[`set${s}FullYear`](o),e[`set${s}Month`](u),e[`set${s}Date`](w),delete n.year,delete n.month,delete n.date,e}function ht(e,n,s){const o=Rt(n),u=new Date(e),c=o.year!==void 0||o.month!==void 0||o.date!==void 0?$a(u,o,s):u;for(const w in o){const d=ma(w);c[`set${d}`](c[`get${d}`]()+s*o[w])}return c}function Rt(e){const n={...e};return e.years!==void 0&&(n.year=e.years,delete n.years),e.months!==void 0&&(n.month=e.months,delete n.months),e.days!==void 0&&(n.date=e.days,delete n.days),e.day!==void 0&&(n.date=e.day,delete n.day),e.hour!==void 0&&(n.hours=e.hour,delete n.hour),e.minute!==void 0&&(n.minutes=e.minute,delete n.minute),e.second!==void 0&&(n.seconds=e.second,delete n.second),e.millisecond!==void 0&&(n.milliseconds=e.millisecond,delete n.millisecond),n}function Jt(e,n,s){const o=Rt(n),u=s===!0?"UTC":"",c=new Date(e),w=o.year!==void 0||o.month!==void 0||o.date!==void 0?Ia(c,o,u):c;for(const d in o){const b=d.charAt(0).toUpperCase()+d.slice(1);w[`set${u}${b}`](o[d])}return w}function Va(e,n,s){const o=Te(e,n,s),u=new Date(o.year,o.month===null?null:o.month-1,o.day===null?1:o.day,o.hour,o.minute,o.second,o.millisecond),c=u.getTimezoneOffset();return o.timezoneOffset===null||o.timezoneOffset===c?u:ht(u,{minutes:o.timezoneOffset-c},1)}function Te(e,n,s,o,u){const c={year:null,month:null,day:null,hour:null,minute:null,second:null,millisecond:null,timezoneOffset:null,dateHash:null,timeHash:null};if(u!==void 0&&Object.assign(c,u),e==null||e===""||typeof e!="string")return c;n===void 0&&(n=Ut);const w=Kt(s,$t.props),d=w.months,b=w.monthsShort,{regex:$,map:y}=Oa(n,w),C=e.match($);if(C===null)return c;let z="";if(y.X!==void 0||y.x!==void 0){const E=parseInt(C[y.X!==void 0?y.X:y.x],10);if(isNaN(E)===!0||E<0)return c;const P=new Date(E*(y.X!==void 0?1e3:1));c.year=P.getFullYear(),c.month=P.getMonth()+1,c.day=P.getDate(),c.hour=P.getHours(),c.minute=P.getMinutes(),c.second=P.getSeconds(),c.millisecond=P.getMilliseconds()}else{if(y.YYYY!==void 0)c.year=parseInt(C[y.YYYY],10);else if(y.YY!==void 0){const E=parseInt(C[y.YY],10);c.year=E<0?E:2e3+E}if(y.M!==void 0){if(c.month=parseInt(C[y.M],10),c.month<1||c.month>12)return c}else y.MMM!==void 0?c.month=b.indexOf(C[y.MMM])+1:y.MMMM!==void 0&&(c.month=d.indexOf(C[y.MMMM])+1);if(y.D!==void 0){if(c.day=parseInt(C[y.D],10),c.year===null||c.month===null||c.day<1)return c;const E=o!=="persian"?new Date(c.year,c.month,0).getDate():We(c.year,c.month);if(c.day>E)return c}y.H!==void 0?c.hour=parseInt(C[y.H],10)%24:y.h!==void 0&&(c.hour=parseInt(C[y.h],10)%12,(y.A&&C[y.A]==="PM"||y.a&&C[y.a]==="pm"||y.aa&&C[y.aa]==="p.m.")&&(c.hour+=12),c.hour=c.hour%24),y.m!==void 0&&(c.minute=parseInt(C[y.m],10)%60),y.s!==void 0&&(c.second=parseInt(C[y.s],10)%60),y.S!==void 0&&(c.millisecond=parseInt(C[y.S],10)*10**(3-C[y.S].length)),(y.Z!==void 0||y.ZZ!==void 0)&&(z=y.Z!==void 0?C[y.Z].replace(":",""):C[y.ZZ],c.timezoneOffset=(z[0]==="+"?-1:1)*(60*z.slice(1,3)+1*z.slice(3,5)))}return c.dateHash=q(c.year,6)+"/"+q(c.month)+"/"+q(c.day),c.timeHash=q(c.hour)+":"+q(c.minute)+":"+q(c.second)+z,c}function Ta(e){return typeof e=="number"?!0:isNaN(Date.parse(e))===!1}function pa(e,n){return Jt(new Date,e,n)}function Fa(e){const n=new Date(e).getDay();return n===0?7:n}function vt(e){const n=new Date(e.getFullYear(),e.getMonth(),e.getDate());n.setDate(n.getDate()-(n.getDay()+6)%7+3);const s=new Date(n.getFullYear(),0,4);s.setDate(s.getDate()-(s.getDay()+6)%7+3);const o=n.getTimezoneOffset()-s.getTimezoneOffset();n.setHours(n.getHours()-o);const u=(n-s)/(Lt*7);return 1+Math.floor(u)}function ja(e){return e.getFullYear()*1e4+e.getMonth()*100+e.getDate()}function rt(e,n){const s=new Date(e);return n===!0?ja(s):s.getTime()}function Aa(e,n,s,o={}){const u=rt(n,o.onlyDate),c=rt(s,o.onlyDate),w=rt(e,o.onlyDate);return(w>u||o.inclusiveFrom===!0&&w===u)&&(w<c||o.inclusiveTo===!0&&w===c)}function Ea(e,n){return ht(e,n,1)}function Ba(e,n){return ht(e,n,-1)}function ue(e,n,s){const o=new Date(e),u=`set${s===!0?"UTC":""}`;switch(n){case"year":case"years":o[`${u}Month`](0);case"month":case"months":o[`${u}Date`](1);case"day":case"days":case"date":o[`${u}Hours`](0);case"hour":case"hours":o[`${u}Minutes`](0);case"minute":case"minutes":o[`${u}Seconds`](0);case"second":case"seconds":o[`${u}Milliseconds`](0)}return o}function Na(e,n,s){const o=new Date(e),u=`set${s===!0?"UTC":""}`;switch(n){case"year":case"years":o[`${u}Month`](11);case"month":case"months":o[`${u}Date`](yt(o));case"day":case"days":case"date":o[`${u}Hours`](23);case"hour":case"hours":o[`${u}Minutes`](59);case"minute":case"minutes":o[`${u}Seconds`](59);case"second":case"seconds":o[`${u}Milliseconds`](999)}return o}function za(e){let n=new Date(e);return Array.prototype.slice.call(arguments,1).forEach(s=>{n=Math.max(n,new Date(s))}),n}function Za(e){let n=new Date(e);return Array.prototype.slice.call(arguments,1).forEach(s=>{n=Math.min(n,new Date(s))}),n}function Xe(e,n,s){return(e.getTime()-e.getTimezoneOffset()*dt-(n.getTime()-n.getTimezoneOffset()*dt))/s}function gt(e,n,s="days"){const o=new Date(e),u=new Date(n);switch(s){case"years":case"year":return o.getFullYear()-u.getFullYear();case"months":case"month":return(o.getFullYear()-u.getFullYear())*12+o.getMonth()-u.getMonth();case"days":case"day":case"date":return Xe(ue(o,"day"),ue(u,"day"),Lt);case"hours":case"hour":return Xe(ue(o,"hour"),ue(u,"hour"),Ya);case"minutes":case"minute":return Xe(ue(o,"minute"),ue(u,"minute"),dt);case"seconds":case"second":return Xe(ue(o,"second"),ue(u,"second"),1e3)}}function ft(e){return gt(e,ue(e,"year"),"days")+1}function Qa(e){return It(e)===!0?"date":typeof e=="number"?"number":"string"}function Pa(e,n,s){const o=new Date(e);if(n){const u=new Date(n);if(o<u)return u}if(s){const u=new Date(s);if(o>u)return u}return o}function La(e,n,s){const o=new Date(e),u=new Date(n);if(s===void 0)return o.getTime()===u.getTime();switch(s){case"second":case"seconds":if(o.getSeconds()!==u.getSeconds())return!1;case"minute":case"minutes":if(o.getMinutes()!==u.getMinutes())return!1;case"hour":case"hours":if(o.getHours()!==u.getHours())return!1;case"day":case"days":case"date":if(o.getDate()!==u.getDate())return!1;case"month":case"months":if(o.getMonth()!==u.getMonth())return!1;case"year":case"years":if(o.getFullYear()!==u.getFullYear())return!1;break;default:throw new Error(`date isSameDate unknown unit ${s}`)}return!0}function yt(e){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()}function qt(e){if(e>=11&&e<=13)return`${e}th`;switch(e%10){case 1:return`${e}st`;case 2:return`${e}nd`;case 3:return`${e}rd`}return`${e}th`}const Ht={YY(e,n,s){const o=this.YYYY(e,n,s)%100;return o>=0?q(o):"-"+q(Math.abs(o))},YYYY(e,n,s){return s!=null?s:e.getFullYear()},M(e){return e.getMonth()+1},MM(e){return q(e.getMonth()+1)},MMM(e,n){return n.monthsShort[e.getMonth()]},MMMM(e,n){return n.months[e.getMonth()]},Q(e){return Math.ceil((e.getMonth()+1)/3)},Qo(e){return qt(this.Q(e))},D(e){return e.getDate()},Do(e){return qt(e.getDate())},DD(e){return q(e.getDate())},DDD(e){return ft(e)},DDDD(e){return q(ft(e),3)},d(e){return e.getDay()},dd(e,n){return this.dddd(e,n).slice(0,2)},ddd(e,n){return n.daysShort[e.getDay()]},dddd(e,n){return n.days[e.getDay()]},E(e){return e.getDay()||7},w(e){return vt(e)},ww(e){return q(vt(e))},H(e){return e.getHours()},HH(e){return q(e.getHours())},h(e){const n=e.getHours();return n===0?12:n>12?n%12:n},hh(e){return q(this.h(e))},m(e){return e.getMinutes()},mm(e){return q(e.getMinutes())},s(e){return e.getSeconds()},ss(e){return q(e.getSeconds())},S(e){return Math.floor(e.getMilliseconds()/100)},SS(e){return q(Math.floor(e.getMilliseconds()/10))},SSS(e){return q(e.getMilliseconds(),3)},A(e){return this.H(e)<12?"AM":"PM"},a(e){return this.H(e)<12?"am":"pm"},aa(e){return this.H(e)<12?"a.m.":"p.m."},Z(e,n,s,o){const u=o==null?e.getTimezoneOffset():o;return Yt(u,":")},ZZ(e,n,s,o){const u=o==null?e.getTimezoneOffset():o;return Yt(u)},X(e){return Math.floor(e.getTime()/1e3)},x(e){return e.getTime()}};function Dt(e,n,s,o,u){if(e!==0&&!e||e===1/0||e===-1/0)return;const c=new Date(e);if(isNaN(c))return;n===void 0&&(n=Ut);const w=Kt(s,$t.props);return n.replace(qa,(d,b)=>d in Ht?Ht[d](c,w,o,u):b===void 0?d:b.split("\\]").join("]"))}function Ua(e){return It(e)===!0?new Date(e.getTime()):e}var Ka={isValid:Ta,extractDate:Va,buildDate:pa,getDayOfWeek:Fa,getWeekOfYear:vt,isBetweenDates:Aa,addToDate:Ea,subtractFromDate:Ba,adjustDate:Jt,startOfDate:ue,endOfDate:Na,getMaxDate:za,getMinDate:Za,getDateDiff:gt,getDayOfYear:ft,inferDateFormat:Qa,getDateBetween:Pa,isSameDate:La,daysInMonth:yt,formatDate:Dt,clone:Ua};const xe=20,Ra=["Calendar","Years","Months"],Ot=e=>Ra.includes(e),it=e=>/^-?[\d]+\/[0-1]\d$/.test(e),Ve=" \u2014 ";function me(e){return e.year+"/"+q(e.month)}var Ja=Vt({name:"QDate",props:{...Zt,...At,...Tt,multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:it},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:it},navigationMaxYearMonth:{type:String,validator:it},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:Ot}},emits:[...Qt,"rangeStart","rangeEnd","navigation"],setup(e,{slots:n,emit:s}){const{proxy:o}=jt(),{$q:u}=o,c=pt(e,u),{getCache:w}=fa(),{tabindex:d,headerClass:b,getLocale:$,getCurrentDate:y}=Pt(e,u);let C;const z=Et(e),E=Bt(z),P=F(null),K=F(Re()),O=F($()),de=_(()=>Re()),ve=_(()=>$()),m=_(()=>y()),l=F(i(K.value,O.value)),D=F(e.defaultView),W=u.lang.rtl===!0?"right":"left",ae=F(W.value),j=F(W.value),B=l.value.year,De=F(B-B%xe-(B<0?xe:0)),L=F(null),Me=_(()=>{const t=e.landscape===!0?"landscape":"portrait";return`q-date q-date--${t} q-date--${t}-${e.minimal===!0?"minimal":"standard"}`+(c.value===!0?" q-date--dark q-dark":"")+(e.bordered===!0?" q-date--bordered":"")+(e.square===!0?" q-date--square no-border-radius":"")+(e.flat===!0?" q-date--flat no-shadow":"")+(e.disable===!0?" disabled":e.readonly===!0?" q-date--readonly":"")}),te=_(()=>e.color||"primary"),ne=_(()=>e.textColor||"white"),U=_(()=>e.emitImmediately===!0&&e.multiple!==!0&&e.range!==!0),re=_(()=>Array.isArray(e.modelValue)===!0?e.modelValue:e.modelValue!==null&&e.modelValue!==void 0?[e.modelValue]:[]),Z=_(()=>re.value.filter(t=>typeof t=="string").map(t=>Be(t,K.value,O.value)).filter(t=>t.dateHash!==null&&t.day!==null&&t.month!==null&&t.year!==null)),le=_(()=>{const t=a=>Be(a,K.value,O.value);return re.value.filter(a=>aa(a)===!0&&a.from!==void 0&&a.to!==void 0).map(a=>({from:t(a.from),to:t(a.to)})).filter(a=>a.from.dateHash!==null&&a.to.dateHash!==null&&a.from.dateHash<a.to.dateHash)}),Ce=_(()=>e.calendar!=="persian"?t=>new Date(t.year,t.month-1,t.day):t=>{const a=St(t.year,t.month,t.day);return new Date(a.gy,a.gm-1,a.gd)}),pe=_(()=>e.calendar==="persian"?ce:(t,a,r)=>Dt(new Date(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),a===void 0?K.value:a,r===void 0?O.value:r,t.year,t.timezoneOffset)),fe=_(()=>Z.value.length+le.value.reduce((t,a)=>t+1+gt(Ce.value(a.to),Ce.value(a.from)),0)),we=_(()=>{if(e.title!==void 0&&e.title!==null&&e.title.length>0)return e.title;if(L.value!==null){const r=L.value.init,g=Ce.value(r);return O.value.daysShort[g.getDay()]+", "+O.value.monthsShort[r.month-1]+" "+r.day+Ve+"?"}if(fe.value===0)return Ve;if(fe.value>1)return`${fe.value} ${O.value.pluralDay}`;const t=Z.value[0],a=Ce.value(t);return isNaN(a.valueOf())===!0?Ve:O.value.headerTitle!==void 0?O.value.headerTitle(a,t):O.value.daysShort[a.getDay()]+", "+O.value.monthsShort[t.month-1]+" "+t.day}),ze=_(()=>Z.value.concat(le.value.map(a=>a.from)).sort((a,r)=>a.year-r.year||a.month-r.month)[0]),Fe=_(()=>Z.value.concat(le.value.map(a=>a.to)).sort((a,r)=>r.year-a.year||r.month-a.month)[0]),Ze=_(()=>{if(e.subtitle!==void 0&&e.subtitle!==null&&e.subtitle.length>0)return e.subtitle;if(fe.value===0)return Ve;if(fe.value>1){const t=ze.value,a=Fe.value,r=O.value.monthsShort;return r[t.month-1]+(t.year!==a.year?" "+t.year+Ve+r[a.month-1]+" ":t.month!==a.month?Ve+r[a.month-1]:"")+" "+a.year}return Z.value[0].year}),Se=_(()=>{const t=[u.iconSet.datetime.arrowLeft,u.iconSet.datetime.arrowRight];return u.lang.rtl===!0?t.reverse():t}),Ye=_(()=>e.firstDayOfWeek!==void 0?Number(e.firstDayOfWeek):O.value.firstDayOfWeek),je=_(()=>{const t=O.value.daysShort,a=Ye.value;return a>0?t.slice(a,7).concat(t.slice(0,a)):t}),oe=_(()=>{const t=l.value;return e.calendar!=="persian"?new Date(t.year,t.month,0).getDate():We(t.year,t.month)}),Qe=_(()=>typeof e.eventColor=="function"?e.eventColor:()=>e.eventColor),A=_(()=>{if(e.navigationMinYearMonth===void 0)return null;const t=e.navigationMinYearMonth.split("/");return{year:parseInt(t[0],10),month:parseInt(t[1],10)}}),N=_(()=>{if(e.navigationMaxYearMonth===void 0)return null;const t=e.navigationMaxYearMonth.split("/");return{year:parseInt(t[0],10),month:parseInt(t[1],10)}}),Ae=_(()=>{const t={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return A.value!==null&&A.value.year>=l.value.year&&(t.year.prev=!1,A.value.year===l.value.year&&A.value.month>=l.value.month&&(t.month.prev=!1)),N.value!==null&&N.value.year<=l.value.year&&(t.year.next=!1,N.value.year===l.value.year&&N.value.month<=l.value.month&&(t.month.next=!1)),t}),qe=_(()=>{const t={};return Z.value.forEach(a=>{const r=me(a);t[r]===void 0&&(t[r]=[]),t[r].push(a.day)}),t}),Pe=_(()=>{const t={};return le.value.forEach(a=>{const r=me(a.from),g=me(a.to);if(t[r]===void 0&&(t[r]=[]),t[r].push({from:a.from.day,to:r===g?a.to.day:void 0,range:a}),r<g){let f;const{year:H,month:M}=a.from,k=M<12?{year:H,month:M+1}:{year:H+1,month:1};for(;(f=me(k))<=g;)t[f]===void 0&&(t[f]=[]),t[f].push({from:void 0,to:f===g?a.to.day:void 0,range:a}),k.month++,k.month>12&&(k.year++,k.month=1)}}),t}),_e=_(()=>{if(L.value===null)return;const{init:t,initHash:a,final:r,finalHash:g}=L.value,[f,H]=a<=g?[t,r]:[r,t],M=me(f),k=me(H);if(M!==R.value&&k!==R.value)return;const I={};return M===R.value?(I.from=f.day,I.includeFrom=!0):I.from=1,k===R.value?(I.to=H.day,I.includeTo=!0):I.to=oe.value,I}),R=_(()=>me(l.value)),Ge=_(()=>{const t={};if(e.options===void 0){for(let r=1;r<=oe.value;r++)t[r]=!0;return t}const a=typeof e.options=="function"?e.options:r=>e.options.includes(r);for(let r=1;r<=oe.value;r++){const g=R.value+"/"+q(r);t[r]=a(g)}return t}),et=_(()=>{const t={};if(e.events===void 0)for(let a=1;a<=oe.value;a++)t[a]=!1;else{const a=typeof e.events=="function"?e.events:r=>e.events.includes(r);for(let r=1;r<=oe.value;r++){const g=R.value+"/"+q(r);t[r]=a(g)===!0&&Qe.value(g)}}return t}),He=_(()=>{let t,a;const{year:r,month:g}=l.value;if(e.calendar!=="persian")t=new Date(r,g-1,1),a=new Date(r,g-1,0).getDate();else{const f=St(r,g,1);t=new Date(f.gy,f.gm-1,f.gd);let H=g-1,M=r;H===0&&(H=12,M--),a=We(M,H)}return{days:t.getDay()-Ye.value-1,endDay:a}}),be=_(()=>{const t=[],{days:a,endDay:r}=He.value,g=a<0?a+7:a;if(g<6)for(let M=r-g;M<=r;M++)t.push({i:M,fill:!0});const f=t.length;for(let M=1;M<=oe.value;M++){const k={i:M,event:et.value[M],classes:[]};Ge.value[M]===!0&&(k.in=!0,k.flat=!0),t.push(k)}if(qe.value[R.value]!==void 0&&qe.value[R.value].forEach(M=>{const k=f+M-1;Object.assign(t[k],{selected:!0,unelevated:!0,flat:!1,color:te.value,textColor:ne.value})}),Pe.value[R.value]!==void 0&&Pe.value[R.value].forEach(M=>{if(M.from!==void 0){const k=f+M.from-1,I=f+(M.to||oe.value)-1;for(let Ne=k;Ne<=I;Ne++)Object.assign(t[Ne],{range:M.range,unelevated:!0,color:te.value,textColor:ne.value});Object.assign(t[k],{rangeFrom:!0,flat:!1}),M.to!==void 0&&Object.assign(t[I],{rangeTo:!0,flat:!1})}else if(M.to!==void 0){const k=f+M.to-1;for(let I=f;I<=k;I++)Object.assign(t[I],{range:M.range,unelevated:!0,color:te.value,textColor:ne.value});Object.assign(t[k],{flat:!1,rangeTo:!0})}else{const k=f+oe.value-1;for(let I=f;I<=k;I++)Object.assign(t[I],{range:M.range,unelevated:!0,color:te.value,textColor:ne.value})}}),_e.value!==void 0){const M=f+_e.value.from-1,k=f+_e.value.to-1;for(let I=M;I<=k;I++)t[I].color=te.value,t[I].editRange=!0;_e.value.includeFrom===!0&&(t[M].editRangeFrom=!0),_e.value.includeTo===!0&&(t[k].editRangeTo=!0)}l.value.year===m.value.year&&l.value.month===m.value.month&&(t[f+m.value.day-1].today=!0);const H=t.length%7;if(H>0){const M=7-H;for(let k=1;k<=M;k++)t.push({i:k,fill:!0})}return t.forEach(M=>{let k="q-date__calendar-item ";M.fill===!0?k+="q-date__calendar-item--fill":(k+=`q-date__calendar-item--${M.in===!0?"in":"out"}`,M.range!==void 0&&(k+=` q-date__range${M.rangeTo===!0?"-to":M.rangeFrom===!0?"-from":""}`),M.editRange===!0&&(k+=` q-date__edit-range${M.editRangeFrom===!0?"-from":""}${M.editRangeTo===!0?"-to":""}`),(M.range!==void 0||M.editRange===!0)&&(k+=` text-${M.color}`)),M.classes=k}),t}),Oe=_(()=>e.disable===!0?{"aria-disabled":"true"}:e.readonly===!0?{"aria-readonly":"true"}:{});ke(()=>e.modelValue,t=>{if(C===t)C=0;else{const a=i(K.value,O.value);J(a.year,a.month,a)}}),ke(D,()=>{P.value!==null&&o.$el.contains(document.activeElement)===!0&&P.value.focus()}),ke(()=>l.value.year+"|"+l.value.month,()=>{s("navigation",{year:l.value.year,month:l.value.month})}),ke(de,t=>{wt(t,O.value,"mask"),K.value=t}),ke(ve,t=>{wt(K.value,t,"locale"),O.value=t});function Le(){const t=m.value,a=qe.value[me(t)];(a===void 0||a.includes(t.day)===!1)&&tt(t),ie(t.year,t.month)}function Ue(t){Ot(t)===!0&&(D.value=t)}function Ke(t,a){["month","year"].includes(t)&&(t==="month"?x:S)(a===!0?-1:1)}function ie(t,a){D.value="Calendar",J(t,a)}function Ee(t,a){if(e.range===!1||!t){L.value=null;return}const r=Object.assign({...l.value},t),g=a!==void 0?Object.assign({...l.value},a):r;L.value={init:r,initHash:ce(r),final:g,finalHash:ce(g)},ie(r.year,r.month)}function Re(){return e.calendar==="persian"?"YYYY/MM/DD":e.mask}function Be(t,a,r){return Te(t,a,r,e.calendar,{hour:0,minute:0,second:0,millisecond:0})}function i(t,a){const r=Array.isArray(e.modelValue)===!0?e.modelValue:e.modelValue?[e.modelValue]:[];if(r.length===0)return v();const g=r[r.length-1],f=Be(g.from!==void 0?g.from:g,t,a);return f.dateHash===null?v():f}function v(){let t,a;if(e.defaultYearMonth!==void 0){const r=e.defaultYearMonth.split("/");t=parseInt(r[0],10),a=parseInt(r[1],10)}else{const r=m.value!==void 0?m.value:y();t=r.year,a=r.month}return{year:t,month:a,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:t+"/"+q(a)+"/01"}}function x(t){let a=l.value.year,r=Number(l.value.month)+t;r===13?(r=1,a++):r===0&&(r=12,a--),J(a,r),U.value===!0&&$e("month")}function S(t){const a=Number(l.value.year)+t;J(a,l.value.month),U.value===!0&&$e("year")}function T(t){J(t,l.value.month),D.value=e.defaultView==="Years"?"Months":"Calendar",U.value===!0&&$e("year")}function G(t){J(l.value.year,t),D.value="Calendar",U.value===!0&&$e("month")}function Y(t,a){const r=qe.value[a];(r!==void 0&&r.includes(t.day)===!0?at:tt)(t)}function p(t){return{year:t.year,month:t.month,day:t.day}}function J(t,a,r){if(A.value!==null&&t<=A.value.year&&(t=A.value.year,a<A.value.month&&(a=A.value.month)),N.value!==null&&t>=N.value.year&&(t=N.value.year,a>N.value.month&&(a=N.value.month)),r!==void 0){const{hour:f,minute:H,second:M,millisecond:k,timezoneOffset:I,timeHash:Ne}=r;Object.assign(l.value,{hour:f,minute:H,second:M,millisecond:k,timezoneOffset:I,timeHash:Ne})}const g=t+"/"+q(a)+"/01";g!==l.value.dateHash&&(ae.value=l.value.dateHash<g==(u.lang.rtl!==!0)?"left":"right",t!==l.value.year&&(j.value=ae.value),st(()=>{De.value=t-t%xe-(t<0?xe:0),Object.assign(l.value,{year:t,month:a,day:1,dateHash:g})}))}function Je(t,a,r){const g=t!==null&&t.length===1&&e.multiple===!1?t[0]:t;C=g;const{reason:f,details:H}=Mt(a,r);s("update:modelValue",g,f,H)}function $e(t){const a=Z.value[0]!==void 0&&Z.value[0].dateHash!==null?{...Z.value[0]}:{...l.value};st(()=>{a.year=l.value.year,a.month=l.value.month;const r=e.calendar!=="persian"?new Date(a.year,a.month,0).getDate():We(a.year,a.month);a.day=Math.min(Math.max(1,a.day),r);const g=Ie(a);C=g;const{details:f}=Mt("",a);s("update:modelValue",g,t,f)})}function Mt(t,a){return a.from!==void 0?{reason:`${t}-range`,details:{...p(a.target),from:p(a.from),to:p(a.to)}}:{reason:`${t}-day`,details:p(a)}}function Ie(t,a,r){return t.from!==void 0?{from:pe.value(t.from,a,r),to:pe.value(t.to,a,r)}:pe.value(t,a,r)}function tt(t){let a;if(e.multiple===!0)if(t.from!==void 0){const r=ce(t.from),g=ce(t.to),f=Z.value.filter(M=>M.dateHash<r||M.dateHash>g),H=le.value.filter(({from:M,to:k})=>k.dateHash<r||M.dateHash>g);a=f.concat(H).concat(t).map(M=>Ie(M))}else{const r=re.value.slice();r.push(Ie(t)),a=r}else a=Ie(t);Je(a,"add",t)}function at(t){if(e.noUnset===!0)return;let a=null;if(e.multiple===!0&&Array.isArray(e.modelValue)===!0){const r=Ie(t);t.from!==void 0?a=e.modelValue.filter(g=>g.from!==void 0?g.from!==r.from&&g.to!==r.to:!0):a=e.modelValue.filter(g=>g!==r),a.length===0&&(a=null)}Je(a,"remove",t)}function wt(t,a,r){const g=Z.value.concat(le.value).map(f=>Ie(f,t,a)).filter(f=>f.from!==void 0?f.from.dateHash!==null&&f.to.dateHash!==null:f.dateHash!==null);s("update:modelValue",(e.multiple===!0?g:g[0])||null,r)}function Xt(){if(e.minimal!==!0)return h("div",{class:"q-date__header "+b.value},[h("div",{class:"relative-position"},[h(ge,{name:"q-transition--fade"},()=>h("div",{key:"h-yr-"+Ze.value,class:"q-date__header-subtitle q-date__header-link "+(D.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:d.value,...w("vY",{onClick(){D.value="Years"},onKeyup(t){t.keyCode===13&&(D.value="Years")}})},[Ze.value]))]),h("div",{class:"q-date__header-title relative-position flex no-wrap"},[h("div",{class:"relative-position col"},[h(ge,{name:"q-transition--fade"},()=>h("div",{key:"h-sub"+we.value,class:"q-date__header-title-label q-date__header-link "+(D.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:d.value,...w("vC",{onClick(){D.value="Calendar"},onKeyup(t){t.keyCode===13&&(D.value="Calendar")}})},[we.value]))]),e.todayBtn===!0?h(X,{class:"q-date__header-today self-start",icon:u.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:d.value,onClick:Le}):null])])}function nt({label:t,type:a,key:r,dir:g,goTo:f,boundaries:H,cls:M}){return[h("div",{class:"row items-center q-date__arrow"},[h(X,{round:!0,dense:!0,size:"sm",flat:!0,icon:Se.value[0],tabindex:d.value,disable:H.prev===!1,...w("go-#"+a,{onClick(){f(-1)}})})]),h("div",{class:"relative-position overflow-hidden flex flex-center"+M},[h(ge,{name:"q-transition--jump-"+g},()=>h("div",{key:r},[h(X,{flat:!0,dense:!0,noCaps:!0,label:t,tabindex:d.value,...w("view#"+a,{onClick:()=>{D.value=a}})})]))]),h("div",{class:"row items-center q-date__arrow"},[h(X,{round:!0,dense:!0,size:"sm",flat:!0,icon:Se.value[1],tabindex:d.value,disable:H.next===!1,...w("go+#"+a,{onClick(){f(1)}})})])]}const Wt={Calendar:()=>[h("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[h("div",{class:"q-date__navigation row items-center no-wrap"},nt({label:O.value.months[l.value.month-1],type:"Months",key:l.value.month,dir:ae.value,goTo:x,boundaries:Ae.value.month,cls:" col"}).concat(nt({label:l.value.year,type:"Years",key:l.value.year,dir:j.value,goTo:S,boundaries:Ae.value.year,cls:""}))),h("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},je.value.map(t=>h("div",{class:"q-date__calendar-item"},[h("div",t)]))),h("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[h(ge,{name:"q-transition--slide-"+ae.value},()=>h("div",{key:R.value,class:"q-date__calendar-days fit"},be.value.map(t=>h("div",{class:t.classes},[t.in===!0?h(X,{class:t.today===!0?"q-date__today":"",dense:!0,flat:t.flat,unelevated:t.unelevated,color:t.color,textColor:t.textColor,label:t.i,tabindex:d.value,...w("day#"+t.i,{onClick:()=>{Gt(t.i)},onMouseover:()=>{ea(t.i)}})},t.event!==!1?()=>h("div",{class:"q-date__event bg-"+t.event}):null):h("div",""+t.i)]))))])])],Months(){const t=l.value.year===m.value.year,a=g=>A.value!==null&&l.value.year===A.value.year&&A.value.month>g||N.value!==null&&l.value.year===N.value.year&&N.value.month<g,r=O.value.monthsShort.map((g,f)=>{const H=l.value.month===f+1;return h("div",{class:"q-date__months-item flex flex-center"},[h(X,{class:t===!0&&m.value.month===f+1?"q-date__today":null,flat:H!==!0,label:g,unelevated:H,color:H===!0?te.value:null,textColor:H===!0?ne.value:null,tabindex:d.value,disable:a(f+1),...w("month#"+f,{onClick:()=>{G(f+1)}})})])});return e.yearsInMonthView===!0&&r.unshift(h("div",{class:"row no-wrap full-width"},[nt({label:l.value.year,type:"Years",key:l.value.year,dir:j.value,goTo:S,boundaries:Ae.value.year,cls:" col"})])),h("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},r)},Years(){const t=De.value,a=t+xe,r=[],g=f=>A.value!==null&&A.value.year>f||N.value!==null&&N.value.year<f;for(let f=t;f<=a;f++){const H=l.value.year===f;r.push(h("div",{class:"q-date__years-item flex flex-center"},[h(X,{key:"yr"+f,class:m.value.year===f?"q-date__today":null,flat:!H,label:f,dense:!0,unelevated:H,color:H===!0?te.value:null,textColor:H===!0?ne.value:null,tabindex:d.value,disable:g(f),...w("yr#"+f,{onClick:()=>{T(f)}})})]))}return h("div",{class:"q-date__view q-date__years flex flex-center"},[h("div",{class:"col-auto"},[h(X,{round:!0,dense:!0,flat:!0,icon:Se.value[0],tabindex:d.value,disable:g(t),...w("y-",{onClick:()=>{De.value-=xe}})})]),h("div",{class:"q-date__years-content col self-stretch row items-center"},r),h("div",{class:"col-auto"},[h(X,{round:!0,dense:!0,flat:!0,icon:Se.value[1],tabindex:d.value,disable:g(a),...w("y+",{onClick:()=>{De.value+=xe}})})])])}};function Gt(t){const a={...l.value,day:t};if(e.range===!1){Y(a,R.value);return}if(L.value===null){const r=be.value.find(f=>f.fill!==!0&&f.i===t);if(e.noUnset!==!0&&r.range!==void 0){at({target:a,from:r.range.from,to:r.range.to});return}if(r.selected===!0){at(a);return}const g=ce(a);L.value={init:a,initHash:g,final:a,finalHash:g},s("rangeStart",p(a))}else{const r=L.value.initHash,g=ce(a),f=r<=g?{from:L.value.init,to:a}:{from:a,to:L.value.init};L.value=null,tt(r===g?a:{target:a,...f}),s("rangeEnd",{from:p(f.from),to:p(f.to)})}}function ea(t){if(L.value!==null){const a={...l.value,day:t};Object.assign(L.value,{final:a,finalHash:ce(a)})}}return Object.assign(o,{setToday:Le,setView:Ue,offsetCalendar:Ke,setCalendarTo:ie,setEditingRange:Ee}),()=>{const t=[h("div",{class:"q-date__content col relative-position"},[h(ge,{name:"q-transition--fade"},Wt[D.value])])],a=Ft(n.default);return a!==void 0&&t.push(h("div",{class:"q-date__actions"},a)),e.name!==void 0&&e.disable!==!0&&E(t,"push"),h("div",{class:Me.value,...Oe.value},[Xt(),h("div",{ref:P,class:"q-date__main col column",tabindex:-1},t)])}}});function Xa(e,n){if(e.hour!==null){if(e.minute===null)return"minute";if(n===!0&&e.second===null)return"second"}return"hour"}function Wa(){const e=new Date;return{hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),millisecond:e.getMilliseconds()}}var Ga=Vt({name:"QTime",props:{...Tt,...At,...Zt,mask:{default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:e=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(e)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean},emits:Qt,setup(e,{slots:n,emit:s}){const o=jt(),{$q:u}=o.proxy,c=pt(e,u),{tabindex:w,headerClass:d,getLocale:b,getCurrentDate:$}=Pt(e,u),y=Et(e),C=Bt(y);let z,E;const P=F(null),K=_(()=>Ze()),O=_(()=>b()),de=_(()=>Se()),ve=Te(e.modelValue,K.value,O.value,e.calendar,de.value),m=F(Xa(ve)),l=F(ve),D=F(ve.hour===null||ve.hour<12),W=_(()=>`q-time q-time--${e.landscape===!0?"landscape":"portrait"}`+(c.value===!0?" q-time--dark q-dark":"")+(e.disable===!0?" disabled":e.readonly===!0?" q-time--readonly":"")+(e.bordered===!0?" q-time--bordered":"")+(e.square===!0?" q-time--square no-border-radius":"")+(e.flat===!0?" q-time--flat no-shadow":"")),ae=_(()=>{const i=l.value;return{hour:i.hour===null?"--":j.value===!0?q(i.hour):String(D.value===!0?i.hour===0?12:i.hour:i.hour>12?i.hour-12:i.hour),minute:i.minute===null?"--":q(i.minute),second:i.second===null?"--":q(i.second)}}),j=_(()=>e.format24h!==null?e.format24h:u.lang.date.format24h),B=_(()=>{const i=m.value==="hour",v=i===!0?12:60,x=l.value[m.value];let T=`rotate(${Math.round(x*(360/v))-180}deg) translateX(-50%)`;return i===!0&&j.value===!0&&l.value.hour>=12&&(T+=" scale(.7)"),{transform:T}}),De=_(()=>l.value.hour!==null),L=_(()=>De.value===!0&&l.value.minute!==null),Me=_(()=>e.hourOptions!==void 0?i=>e.hourOptions.includes(i):e.options!==void 0?i=>e.options(i,null,null):null),te=_(()=>e.minuteOptions!==void 0?i=>e.minuteOptions.includes(i):e.options!==void 0?i=>e.options(l.value.hour,i,null):null),ne=_(()=>e.secondOptions!==void 0?i=>e.secondOptions.includes(i):e.options!==void 0?i=>e.options(l.value.hour,l.value.minute,i):null),U=_(()=>{if(Me.value===null)return null;const i=we(0,11,Me.value),v=we(12,11,Me.value);return{am:i,pm:v,values:i.values.concat(v.values)}}),re=_(()=>te.value!==null?we(0,59,te.value):null),Z=_(()=>ne.value!==null?we(0,59,ne.value):null),le=_(()=>{switch(m.value){case"hour":return U.value;case"minute":return re.value;case"second":return Z.value}}),Ce=_(()=>{let i,v,x=0,S=1;const T=le.value!==null?le.value.values:void 0;m.value==="hour"?j.value===!0?(i=0,v=23):(i=0,v=11,D.value===!1&&(x=12)):(i=0,v=55,S=5);const G=[];for(let Y=i,p=i;Y<=v;Y+=S,p++){const J=Y+x,Je=T!==void 0&&T.includes(J)===!1,$e=m.value==="hour"&&Y===0?j.value===!0?"00":"12":Y;G.push({val:J,index:p,disable:Je,label:$e})}return G}),pe=_(()=>[[ha,oe,void 0,{stop:!0,prevent:!0,mouse:!0}]]);ke(()=>e.modelValue,i=>{const v=Te(i,K.value,O.value,e.calendar,de.value);(v.dateHash!==l.value.dateHash||v.timeHash!==l.value.timeHash)&&(l.value=v,v.hour===null?m.value="hour":D.value=v.hour<12)}),ke([K,O],()=>{st(()=>{Ee()})});function fe(){const i={...$(),...Wa()};Ee(i),Object.assign(l.value,i),m.value="hour"}function we(i,v,x){const S=Array.apply(null,{length:v+1}).map((T,G)=>{const Y=G+i;return{index:Y,val:x(Y)===!0}}).filter(T=>T.val===!0).map(T=>T.index);return{min:S[0],max:S[S.length-1],values:S,threshold:v+1}}function ze(i,v,x){const S=Math.abs(i-v);return Math.min(S,x-S)}function Fe(i,{min:v,max:x,values:S,threshold:T}){if(i===v)return v;if(i<v||i>x)return ze(i,v,T)<=ze(i,x,T)?v:x;const G=S.findIndex(J=>i<=J),Y=S[G-1],p=S[G];return i-Y<=p-i?Y:p}function Ze(){return e.calendar!=="persian"&&e.mask!==null?e.mask:`HH:mm${e.withSeconds===!0?":ss":""}`}function Se(){if(typeof e.defaultDate!="string"){const i=$(!0);return i.dateHash=ce(i),i}return Te(e.defaultDate,"YYYY/MM/DD",void 0,e.calendar)}function Ye(){return la(o)===!0||le.value!==null&&(le.value.values.length===0||m.value==="hour"&&j.value!==!0&&U.value[D.value===!0?"am":"pm"].values.length===0)}function je(){const i=P.value,{top:v,left:x,width:S}=i.getBoundingClientRect(),T=S/2;return{top:v+T,left:x+T,dist:T*.7}}function oe(i){if(Ye()!==!0){if(i.isFirst===!0){z=je(),E=A(i.evt,z);return}E=A(i.evt,z,E),i.isFinal===!0&&(z=!1,E=null,Qe())}}function Qe(){m.value==="hour"?m.value="minute":e.withSeconds&&m.value==="minute"&&(m.value="second")}function A(i,v,x){const S=na(i),T=Math.abs(S.top-v.top),G=Math.sqrt(Math.pow(Math.abs(S.top-v.top),2)+Math.pow(Math.abs(S.left-v.left),2));let Y,p=Math.asin(T/G)*(180/Math.PI);if(S.top<v.top?p=v.left<S.left?90-p:270+p:p=v.left<S.left?p+90:270-p,m.value==="hour"){if(Y=p/30,U.value!==null){const J=j.value!==!0?D.value===!0:U.value.am.values.length>0&&U.value.pm.values.length>0?G>=v.dist:U.value.am.values.length>0;Y=Fe(Y+(J===!0?0:12),U.value[J===!0?"am":"pm"])}else Y=Math.round(Y),j.value===!0?G<v.dist?Y<12&&(Y+=12):Y===12&&(Y=0):D.value===!0&&Y===12?Y=0:D.value===!1&&Y!==12&&(Y+=12);j.value===!0&&(D.value=Y<12)}else Y=Math.round(p/6)%60,m.value==="minute"&&re.value!==null?Y=Fe(Y,re.value):m.value==="second"&&Z.value!==null&&(Y=Fe(Y,Z.value));return x!==Y&&Le[m.value](Y),Y}const N={hour(){m.value="hour"},minute(){m.value="minute"},second(){m.value="second"}};function Ae(i){i.keyCode===13&&Ue()}function qe(i){i.keyCode===13&&Ke()}function Pe(i){Ye()!==!0&&(u.platform.is.desktop!==!0&&A(i,je()),Qe())}function _e(i){Ye()!==!0&&A(i,je())}function R(i){if(i.keyCode===13)m.value="hour";else if([37,39].includes(i.keyCode)){const v=i.keyCode===37?-1:1;if(U.value!==null){const x=j.value===!0?U.value.values:U.value[D.value===!0?"am":"pm"].values;if(x.length===0)return;if(l.value.hour===null)He(x[0]);else{const S=(x.length+x.indexOf(l.value.hour)+v)%x.length;He(x[S])}}else{const x=j.value===!0?24:12,S=j.value!==!0&&D.value===!1?12:0,T=l.value.hour===null?-v:l.value.hour;He(S+(24+T+v)%x)}}}function Ge(i){if(i.keyCode===13)m.value="minute";else if([37,39].includes(i.keyCode)){const v=i.keyCode===37?-1:1;if(re.value!==null){const x=re.value.values;if(x.length===0)return;if(l.value.minute===null)be(x[0]);else{const S=(x.length+x.indexOf(l.value.minute)+v)%x.length;be(x[S])}}else{const x=l.value.minute===null?-v:l.value.minute;be((60+x+v)%60)}}}function et(i){if(i.keyCode===13)m.value="second";else if([37,39].includes(i.keyCode)){const v=i.keyCode===37?-1:1;if(Z.value!==null){const x=Z.value.values;if(x.length===0)return;if(l.value.seconds===null)Oe(x[0]);else{const S=(x.length+x.indexOf(l.value.second)+v)%x.length;Oe(x[S])}}else{const x=l.value.second===null?-v:l.value.second;Oe((60+x+v)%60)}}}function He(i){l.value.hour!==i&&(l.value.hour=i,ie())}function be(i){l.value.minute!==i&&(l.value.minute=i,ie())}function Oe(i){l.value.second!==i&&(l.value.second=i,ie())}const Le={hour:He,minute:be,second:Oe};function Ue(){D.value===!1&&(D.value=!0,l.value.hour!==null&&(l.value.hour-=12,ie()))}function Ke(){D.value===!0&&(D.value=!1,l.value.hour!==null&&(l.value.hour+=12,ie()))}function ie(){if(Me.value!==null&&Me.value(l.value.hour)!==!0){l.value=Te(),m.value="hour";return}if(te.value!==null&&te.value(l.value.minute)!==!0){l.value.minute=null,l.value.second=null,m.value="minute";return}if(e.withSeconds===!0&&ne.value!==null&&ne.value(l.value.second)!==!0){l.value.second=null,m.value="second";return}l.value.hour===null||l.value.minute===null||e.withSeconds===!0&&l.value.second===null||Ee()}function Ee(i){const v=Object.assign({...l.value},i),x=e.calendar==="persian"?q(v.hour)+":"+q(v.minute)+(e.withSeconds===!0?":"+q(v.second):""):Dt(new Date(v.year,v.month===null?null:v.month-1,v.day,v.hour,v.minute,v.second,v.millisecond),K.value,O.value,v.year,v.timezoneOffset);v.changed=x!==e.modelValue,s("update:modelValue",x,v)}function Re(){const i=[h("div",{class:"q-time__link "+(m.value==="hour"?"q-time__link--active":"cursor-pointer"),tabindex:w.value,onClick:N.hour,onKeyup:R},ae.value.hour),h("div",":"),h("div",De.value===!0?{class:"q-time__link "+(m.value==="minute"?"q-time__link--active":"cursor-pointer"),tabindex:w.value,onKeyup:Ge,onClick:N.minute}:{class:"q-time__link"},ae.value.minute)];e.withSeconds===!0&&i.push(h("div",":"),h("div",L.value===!0?{class:"q-time__link "+(m.value==="second"?"q-time__link--active":"cursor-pointer"),tabindex:w.value,onKeyup:et,onClick:N.second}:{class:"q-time__link"},ae.value.second));const v=[h("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},i)];return j.value===!1&&v.push(h("div",{class:"q-time__header-ampm column items-between no-wrap"},[h("div",{class:"q-time__link "+(D.value===!0?"q-time__link--active":"cursor-pointer"),tabindex:w.value,onClick:Ue,onKeyup:Ae},"AM"),h("div",{class:"q-time__link "+(D.value!==!0?"q-time__link--active":"cursor-pointer"),tabindex:w.value,onClick:Ke,onKeyup:qe},"PM")])),h("div",{class:"q-time__header flex flex-center no-wrap "+d.value},v)}function Be(){const i=l.value[m.value];return h("div",{class:"q-time__content col relative-position"},[h(ge,{name:"q-transition--scale"},()=>h("div",{key:"clock"+m.value,class:"q-time__container-parent absolute-full"},[h("div",{ref:P,class:"q-time__container-child fit overflow-hidden"},[ct(h("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:Pe,onMousedown:_e},[h("div",{class:"q-time__clock-circle fit"},[h("div",{class:"q-time__clock-pointer"+(l.value[m.value]===null?" hidden":e.color!==void 0?` text-${e.color}`:""),style:B.value}),Ce.value.map(v=>h("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${v.index}`+(v.val===i?" q-time__clock-position--active "+d.value:v.disable===!0?" q-time__clock-position--disable":"")},[h("span",v.label)]))])]),pe.value)])])),e.nowBtn===!0?h(X,{class:"q-time__now-button absolute",icon:u.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:e.color,textColor:e.textColor,tabindex:w.value,onClick:fe}):null])}return o.proxy.setNow=fe,()=>{const i=[Be()],v=Ft(n.default);return v!==void 0&&i.push(h("div",{class:"q-time__actions"},v)),e.name!==void 0&&e.disable!==!0&&C(i,"push"),h("div",{class:W.value,tabindex:-1},[Re(),h("div",{class:"q-time__main col overflow-auto"},i)])}}});const en=he("div",{class:"text-h6"},"Choose configuration date",-1),tn={class:"tw-flex tw-items-center"},an={key:0,class:"tw-mt-3"},nn={class:"tw-flex-grow tw-flex tw-justify-center tw-items-center tw-min-h-[3.5rem]"},ln=["onClick"],on={class:"tw-self-center tw-flex tw-ml-3"},Yn=oa({__name:"TimeArchivePage",setup(e){const n=ua(),s=wa(),o=F([]),u=F([]),c=F(""),w=F(!0),d=F(!1),b=F(""),$=F(.1),y=m=>{o.value=m},C=async(m,l)=>{var ae,j;if(de.value.length!==Object.keys(O.value).length)return;const D={where:{}};de.value.forEach(B=>{D.where[B.name]={$eq:null}});let W=[];o.value.forEach(B=>{B&&B.name!=="__NONE__"&&(D.where[B.base]=B.name,W.push(B.name))}),l===void 0?u.value.push({id:Math.random().toString(),loading:!0,path:W.join(" / ")}):u.value[l].loading=!0,l=l||u.value.length-1,m=m||new Date;try{const B=await ia.get(`configurations/findByDate?filter=${JSON.stringify(D.where,null,"")}&date=${m.toISOString()}`);B.status===200&&((ae=B.data)==null?void 0:ae.effectiveDate)?(u.value[l].configuration=[B.data],u.value[l].version=0,u.value[l].effectiveDate=m,u.value[l].loading=!1):(s.notify({color:"negative",position:"top",textColor:"secondary",icon:"sym_o_error",message:"Configuration didn't exist at that time"}),(j=u.value[l])!=null&&j.effectiveDate?u.value[l].loading=!1:u.value.splice(l,1))}catch{s.notify({color:"negative",position:"top",textColor:"secondary",icon:"sym_o_error",message:"Error collecting configuration data"}),u.value.splice(l,1)}},z=m=>{u.value=u.value.filter(l=>l.id!==m)},E=m=>{const l=u.value.find(D=>`${D.id}`===m.sourceId);if(l){const D=u.value.findIndex(W=>`${W.id}`===m.targetId);D>=0&&(u.value=u.value.filter(W=>`${W.id}`!==m.sourceId),u.value.splice(D,0,l))}},P=m=>{const l=m.effectiveDate?m.effectiveDate:new Date;b.value=Ka.formatDate(l,"YYYY-MM-DDTHH:mm:ss.SSSZ"),$.value=m.id,d.value=!0},K=()=>{const m=u.value.findIndex(l=>l.id===$.value);m>=0&&C(new Date(b.value),m)},O=_(()=>{if(!o.value)return{};const m={};return o.value.forEach(l=>{l!=null&&l.base&&(m[l.base]=l.name)}),m}),de=_(()=>n.getBases),ve=_(()=>{const m=new Set;return u.value.forEach(l=>{l.configuration&&l.configuration[0].variables&&l.configuration[0].variables.forEach(D=>{m.add(D.name)})}),Array.from(m).sort((l,D)=>l.localeCompare(D,void 0,{sensitivity:"base"}))});return(m,l)=>(ot(),_t("div",null,[Q(ra,{modelValue:d.value,"onUpdate:modelValue":l[2]||(l[2]=D=>d.value=D)},{default:se(()=>[Q(sa,{class:"tw-min-w-[20rem] tw-max-w-full"},{default:se(()=>[Q(bt,{class:"tw-bg-dark"},{default:se(()=>[en]),_:1}),Q(bt,{class:"tw-bg-darkPage tw-grid tw-grid-cols-2 tw-gap-3"},{default:se(()=>[Q(Ja,{modelValue:b.value,"onUpdate:modelValue":l[0]||(l[0]=D=>b.value=D),class:"tw-border-2 tw-border-gray-700",mask:"YYYY-MM-DDTHH:mm:ss.SSSZ",flat:""},null,8,["modelValue"]),Q(Ga,{modelValue:b.value,"onUpdate:modelValue":l[1]||(l[1]=D=>b.value=D),class:"tw-border-2 tw-border-gray-700",mask:"YYYY-MM-DDTHH:mm:ss.SSSZ","with-seconds":"",flat:""},null,8,["modelValue"])]),_:1}),Q(ca,{align:"right",class:"tw-bg-darkPage"},{default:se(()=>[ct(Q(X,{color:"secondary",flat:"",label:"Cancel"},null,512),[[Ct]]),ct(Q(X,{color:"secondary",flat:"",label:"Ok",onClick:K},null,512),[[Ct]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),he("div",tn,[Q(ya,{class:"tw-flex-grow","onUpdate:baseModels":y}),he("div",null,[Q(X,{disable:lt(de).length!==Object.keys(lt(O)).length||u.value.length>3,flat:"",icon:"sym_o_add",onClick:l[3]||(l[3]=D=>C())},null,8,["disable"])])]),Q(ge,{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:se(()=>[u.value.length>0?(ot(),da(Da,{key:0,filter:c.value,"onUpdate:filter":l[4]||(l[4]=D=>c.value=D),showDiff:w.value,"onUpdate:showDiff":l[5]||(l[5]=D=>w.value=D),"export-enabled":!1,"import-enabled":!1,class:"tw-mt-3",title:"Archive"},null,8,["filter","showDiff"])):xt("",!0)]),_:1}),Q(ge,{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:se(()=>[u.value.length>0?(ot(),_t("div",an,[Q(Ma,{configs:u.value,filter:c.value,showDiff:w.value,variables:lt(ve),onRemoveConfiguration:z,onSwitchPlaces:E},{header:se(D=>[he("div",nn,[he("div",null,[he("div",null,kt(D.path),1),he("div",{class:"tw-text-accent tw-cursor-pointer tw-font-light tw-underline tw-text-xs",onClick:W=>P(D)},kt(D.effectiveDate.toLocaleString()),9,ln)]),he("div",on,[Q(ga,{inset:"",size:"md",vertical:""}),Q(X,{flat:"",padding:"0.25rem"},{default:se(()=>[Q(va,{name:"sym_o_close",size:"sm",onClick:W=>z(D.id)},null,8,["onClick"])]),_:2},1024)])])]),_:1},8,["configs","filter","showDiff","variables"])])):xt("",!0)]),_:1})]))}});export{Yn as default};
