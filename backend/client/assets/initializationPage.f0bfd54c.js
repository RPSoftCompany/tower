import{Q as g,a as p,b as f}from"./QPage.23dc3a3e.js";import{Q as y}from"./QInput.72a273ff.js";import{E as _,a3 as v,x as l,c as b,w as a,G as Q,o as h,H as n,a as e,a4 as x,a5 as k,Q as z,I,J as S}from"./index.d78f815c.js";import{u as V}from"./use-quasar.6ef15f16.js";import"./use-key-composition.8fe7b499.js";import"./uid.42677368.js";const B={class:"tw-grid tw-grid-cols-1 tw-gap-1 tw-w-1/5 tw-justify-items-center animate__animated animate__bounce"},C=n("div",null,"Set encryption key",-1),D=_({__name:"initializationPage",setup(j){const c=V(),u=Q(),m=v(),t=l(""),o=l(!1),w=async()=>{var s;if(((s=t.value)==null?void 0:s.length)===32){try{o.value=!0,await S.post(`/configurations/initialize?secret=${t.value}`),m.setInitialized(!0),await u.push("/login")}catch{c.notify({color:"negative",position:"top",textColor:"secondary",icon:"sym_o_error",message:"Invalid token"})}o.value=!1}};return(s,i)=>(h(),b(g,{class:"row items-center justify-evenly"},{default:a(()=>[n("div",B,[e(p,{alt:"Tower configuration server logo",class:"tw-h-40 tw-w-40 tw-mb-10 tw-min-w-[10rem]","spinner-color":"secondary",src:"img/tower.png"}),e(f,{autofocus:"",class:"tw-w-full tw-grid tw-grid-cols-1 tw-gap-1 tw-justify-items-center",greedy:"",onSubmit:w},{default:a(()=>{var r;return[e(y,{modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=d=>t.value=d),class:"tw-w-full tw-min-w-[10rem] tw-max-w-[25rem]",color:"secondary",label:"Encryption key","lazy-rules":"","bottom-slots":""},{counter:a(()=>[n("div",{class:x({"tw-text-negative":t.value.length!==32})},k(t.value.length)+"/32 ",3)]),_:1},8,["modelValue"]),e(z,{loading:o.value,class:"tw-mt-5 tw-bg-secondary",disable:((r=t.value)==null?void 0:r.length)!==32,flat:"","text-color":"primary",type:"submit"},{default:a(()=>[e(I,{class:"tw-mr-3",color:"dark",name:"sym_o_key"}),C]),_:1},8,["loading","disable"])]}),_:1})])]),_:1}))}});export{D as default};
