import{x as j,d as m,j as ae,V as de,O as ne,a2 as ce,h as V,b as fe,U as me,_ as ve,E as ie,o as P,c as L,w as y,a as f,I as q,a7 as A,aX as oe,Q,k as ge,aa as pe,aL as ye,H as E,aF as J,a9 as X,a5 as O,aG as we,aH as Z,aI as be,aJ as ee,a8 as H,aK as te}from"./index.d78f815c.js";import{b as xe,h as Fe}from"./QSelect.77d64708.js";import{u as _e,a as he,b as Ce,d as Se,c as ke,e as Ve,f as le}from"./use-key-composition.8fe7b499.js";import{u as De,Q as ze}from"./QInput.72a273ff.js";import{Q as M}from"./QTooltip.cf77d385.js";import{u as Ee}from"./use-quasar.6ef15f16.js";import{_ as Ie}from"./plugin-vue_export-helper.21dcd24c.js";function I(e,r,F,g){const l=[];return e.forEach(s=>{g(s)===!0?l.push(s):r.push({failedPropValidation:F,file:s})}),l}function U(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),ne(e)}const je={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Ne=["rejected"];function Te({editable:e,dnd:r,getFileInput:F,addFilesToQueue:g}){const{props:l,emit:s,proxy:p}=ae(),_=j(null),C=m(()=>l.accept!==void 0?l.accept.split(",").map(t=>(t=t.trim(),t==="*"?"*/":(t.endsWith("/*")&&(t=t.slice(0,t.length-1)),t.toUpperCase()))):null),D=m(()=>parseInt(l.maxFiles,10)),k=m(()=>parseInt(l.maxTotalSize,10));function z(t){if(e.value)if(t!==Object(t)&&(t={target:null}),t.target!==null&&t.target.matches('input[type="file"]')===!0)t.clientX===0&&t.clientY===0&&de(t);else{const x=F();x&&x!==t.target&&x.click(t)}}function d(t){e.value&&t&&g(null,t)}function o(t,x,N,T){let n=Array.from(x||t.target.files);const b=[],S=()=>{b.length>0&&s("rejected",b)};if(l.accept!==void 0&&C.value.indexOf("*/")===-1&&(n=I(n,b,"accept",i=>C.value.some(c=>i.type.toUpperCase().startsWith(c)||i.name.toUpperCase().endsWith(c))),n.length===0))return S();if(l.maxFileSize!==void 0){const i=parseInt(l.maxFileSize,10);if(n=I(n,b,"max-file-size",c=>c.size<=i),n.length===0)return S()}if(l.multiple!==!0&&n.length>0&&(n=[n[0]]),n.forEach(i=>{i.__key=i.webkitRelativePath+i.lastModified+i.name+i.size}),T===!0){const i=N.map(c=>c.__key);n=I(n,b,"duplicate",c=>i.includes(c.__key)===!1)}if(n.length===0)return S();if(l.maxTotalSize!==void 0){let i=T===!0?N.reduce((c,K)=>c+K.size,0):0;if(n=I(n,b,"max-total-size",c=>(i+=c.size,i<=k.value)),n.length===0)return S()}if(typeof l.filter=="function"){const i=l.filter(n);n=I(n,b,"filter",c=>i.includes(c))}if(l.maxFiles!==void 0){let i=T===!0?N.length:0;if(n=I(n,b,"max-files",()=>(i++,i<=D.value)),n.length===0)return S()}if(S(),n.length>0)return n}function v(t){U(t),r.value!==!0&&(r.value=!0)}function u(t){ne(t),(t.relatedTarget!==null||ce.is.safari!==!0?t.relatedTarget!==_.value:document.elementsFromPoint(t.clientX,t.clientY).includes(_.value)===!1)===!0&&(r.value=!1)}function B(t){U(t);const x=t.dataTransfer.files;x.length>0&&g(null,x),r.value=!1}function R(t){if(r.value===!0)return V("div",{ref:_,class:`q-${t}__dnd absolute-full`,onDragenter:U,onDragover:U,onDragleave:u,onDrop:B})}return Object.assign(p,{pickFiles:z,addFiles:d}),{pickFiles:z,addFiles:d,onDragover:v,onDragleave:u,processFiles:o,getDndNode:R,maxFilesNumber:D,maxTotalSizeNumber:k}}var Pe=fe({name:"QFile",inheritAttrs:!1,props:{..._e,...he,...je,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Ce,...Ne],setup(e,{slots:r,emit:F,attrs:g}){const{proxy:l}=ae(),s=Se(),p=j(null),_=j(!1),C=ke(e),{pickFiles:D,onDragover:k,onDragleave:z,processFiles:d,getDndNode:o}=Te({editable:s.editable,dnd:_,getFileInput:Y,addFilesToQueue:G}),v=De(e),u=m(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),B=m(()=>le(u.value)),R=m(()=>u.value.map(a=>a.name).join(", ")),t=m(()=>Fe(u.value.reduce((a,w)=>a+w.size,0))),x=m(()=>({totalSize:t.value,filesNumber:u.value.length,maxFiles:e.maxFiles})),N=m(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:C.value,...g,id:s.targetUid.value,disabled:s.editable.value!==!0})),T=m(()=>"q-file q-field--auto-height"+(_.value===!0?" q-file--dnd":"")),n=m(()=>e.multiple===!0&&e.append===!0);function b(a){const w=u.value.slice();w.splice(a,1),i(w)}function S(a){const w=u.value.findIndex(a);w>-1&&b(w)}function i(a){F("update:modelValue",e.multiple===!0?a:a[0])}function c(a){a.keyCode===13&&ve(a)}function K(a){(a.keyCode===13||a.keyCode===32)&&D(a)}function Y(){return p.value}function G(a,w){const h=d(a,w,u.value,n.value),W=Y();W!=null&&(W.value=""),h!==void 0&&((e.multiple===!0?e.modelValue&&h.every(re=>u.value.includes(re)):e.modelValue===h[0])||i(n.value===!0?u.value.concat(h):h))}function $(){return[V("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function se(){if(r.file!==void 0)return u.value.length===0?$():u.value.map((w,h)=>r.file({index:h,file:w,ref:this}));if(r.selected!==void 0)return u.value.length===0?$():r.selected({files:u.value,ref:this});if(e.useChips===!0)return u.value.length===0?$():u.value.map((w,h)=>V(xe,{key:"file-"+h,removable:s.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{b(h)}},()=>V("span",{class:"ellipsis",textContent:w.name})));const a=e.displayValue!==void 0?e.displayValue:R.value;return a.length>0?[V("div",{class:e.inputClass,style:e.inputStyle,textContent:a})]:$()}function ue(){const a={ref:p,...N.value,...v.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:G};return e.multiple===!0&&(a.multiple=!0),V("input",a)}return Object.assign(s,{fieldClass:T,emitValue:i,hasValue:B,inputRef:p,innerValue:u,floatingLabel:m(()=>B.value===!0||le(e.displayValue)),computedCounter:m(()=>{if(e.counterLabel!==void 0)return e.counterLabel(x.value);const a=e.maxFiles;return`${u.value.length}${a!==void 0?" / "+a:""} (${t.value})`}),getControlChild:()=>o("file"),getControl:()=>{const a={ref:s.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return s.editable.value===!0&&Object.assign(a,{onDragover:k,onDragleave:z,onKeydown:c,onKeyup:K}),V("div",a,[ue()].concat(se()))}}),Object.assign(l,{removeAtIndex:b,removeFile:S,getNativeElement:()=>p.value}),me(l,"nativeEl",()=>p.value),Ve(s)}});const Qe=ie({__name:"towerToggleIcon",props:{icon:null,toggled:{type:Boolean},size:null},emits:["update:toggled"],setup(e,{emit:r}){const F=e,g=m({get:()=>F.toggled,set:l=>r("update:toggled",l)});return(l,s)=>(P(),L(Q,{class:"tw-relative tw-cursor-pointer",flat:"",padding:"0.5rem",onClick:s[0]||(s[0]=p=>g.value=!A(g))},{default:y(()=>[f(q,{name:e.icon,size:e.size},null,8,["name","size"]),f(q,{color:A(g)?"positive":"negative",name:A(g)?"sym_o_done":"sym_o_close",class:"tw-absolute yesNoIcon heavy",size:"xs"},null,8,["color","name"]),oe(l.$slots,"default",{},void 0,!0)]),_:3}))}});var Ae=Ie(Qe,[["__scopeId","data-v-2a799cdb"]]);const Be={class:"tw-bg-dark tw-text-secondary tw-px-4 tw-rounded"},$e={class:"text-h6"},Oe={class:"tw-w-full tw-grid tw-grid-cols-3 tw-gap-3 tw-py-2 tw-justify-items-stretch tw-justify-self-center tw-place-items-center"},Ue={class:"tw-flex tw-col-auto"},Le={class:"tw-text-secondary tw-text-base tw-font-semibold tw-col-auto tw-text-center"},qe={class:"tw-col-auto"},Re={class:"tw-w-full tw-grid tw-gap-3 tw-grid-flow-col tw-auto-cols-max tw-place-content-end"},Je=ie({__name:"searchToolbar",props:{title:{default:""},filter:{default:""},showDiff:{type:Boolean,default:!0},importEnabled:{type:Boolean,default:!1},exportEnabled:{type:Boolean,default:!1},showDiffEnabled:{type:Boolean,default:!0}},emits:["update:filter","update:showDiff","importClicked","exportClicked"],setup(e,{emit:r}){const F=e,g=Ee(),l=j({inputFile:null}),s=j(!1),p=j(!1),_=m({get:()=>F.filter,set:d=>r("update:filter",d)}),C=m({get:()=>F.showDiff,set:d=>r("update:showDiff",d)}),D=()=>{g.notify({type:"negative",message:"Uploaded file did not pass validation constraints"})},k=d=>{if(d){const o={inputFile:l.value.inputFile,fileData:l.value.fileData};r("exportClicked",o)}l.value.inputFile=null,l.value.fileData=void 0},z=()=>{p.value=!0;const d=new FileReader;d.addEventListener("load",()=>{l.value.fileData=d.result,p.value=!1},!1),d.addEventListener("error",()=>{p.value=!1,g.notify({type:"negative",message:"Error reading input file"})},!1),d.readAsText(l.value.inputFile)};return ge(()=>l.value.inputFile,d=>{d&&z()}),(d,o)=>(P(),pe("div",Be,[f(ye,{modelValue:s.value,"onUpdate:modelValue":o[3]||(o[3]=v=>s.value=v),persistent:""},{default:y(()=>[f(we,{class:"tw-min-w-[30%]"},{default:y(()=>[f(Z,{class:"tw-bg-dark"},{default:y(()=>[E("div",$e,"Export "+O(e.title.toLowerCase()),1)]),_:1}),f(Z,{class:"tw-bg-darkPage"},{default:y(()=>[f(Pe,{modelValue:l.value.inputFile,"onUpdate:modelValue":o[0]||(o[0]=v=>l.value.inputFile=v),loading:p.value,accept:".json",color:"secondary",dense:"",label:"Source file name",onRejected:D},{prepend:y(()=>[f(q,{name:"sym_o_attach_file"})]),_:1},8,["modelValue","loading"])]),_:1}),f(be,{align:"right",class:"tw-bg-darkPage"},{default:y(()=>[ee(f(Q,{color:"secondary",flat:"",label:"Cancel",onClick:o[1]||(o[1]=v=>k(!1))},null,512),[[te]]),ee(f(Q,{disable:!l.value.inputFile||p.value,color:"secondary",flat:"",label:"Export",onClick:o[2]||(o[2]=v=>k(!0))},null,8,["disable"]),[[te]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),E("div",Oe,[E("div",Ue,[f(ze,{modelValue:A(_),"onUpdate:modelValue":o[4]||(o[4]=v=>J(_)?_.value=v:null),debounce:300,class:"tw-flex-grow","clear-icon":"sym_o_close",clearable:"",color:"secondary",dense:"",label:"Filter"},{prepend:y(()=>[f(q,{name:"sym_o_search"})]),_:1},8,["modelValue"]),e.showDiffEnabled?(P(),L(Ae,{key:0,toggled:A(C),"onUpdate:toggled":o[5]||(o[5]=v=>J(C)?C.value=v:null),class:"tw-self-center tw-ml-2",icon:"sym_o_difference",size:"sm"},{default:y(()=>[f(M,{delay:300},{default:y(()=>[H("Show differences")]),_:1})]),_:1},8,["toggled"])):X("",!0)]),E("div",Le,O(e.title),1),E("div",qe,[E("div",Re,[oe(d.$slots,"beforeImport"),e.importEnabled?(P(),L(Q,{key:0,color:"transparent",flat:"",icon:"sym_o_cloud_download",padding:"sm","text-color":"secondary",onClick:o[6]||(o[6]=v=>r("importClicked"))},{default:y(()=>[f(M,null,{default:y(()=>[H("Import "+O(e.title.toLowerCase()),1)]),_:1})]),_:1})):X("",!0),e.exportEnabled?(P(),L(Q,{key:1,color:"transparent",flat:"",icon:"sym_o_cloud_upload",padding:"sm","text-color":"secondary",onClick:o[7]||(o[7]=v=>s.value=!0)},{default:y(()=>[f(M,null,{default:y(()=>[H("Export "+O(e.title.toLowerCase()),1)]),_:1})]),_:1})):X("",!0)])])])]))}});export{Je as _};
